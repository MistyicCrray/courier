<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xhr.courier.dao.CourierOrderMapper">
	<resultMap id="BaseResultMap" type="com.xhr.courier.model.CourierOrder">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		<id column="id" jdbcType="INTEGER" property="id" />
		<result column="user_id" jdbcType="INTEGER" property="userId" />
		<result column="address_id" jdbcType="VARCHAR" property="addressId" />
		<result column="pickup_code" jdbcType="VARCHAR" property="pickupCode" />
		<result column="courier" jdbcType="VARCHAR" property="courier" />
		<result column="order_id" jdbcType="INTEGER" property="orderId" />
		<result column="remark" jdbcType="VARCHAR" property="remark" />
		<result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
		<result column="cabinet_time" jdbcType="TIMESTAMP" property="cabinetTime" />
		<result column="status" jdbcType="VARCHAR" property="status" />
		<result column="order_user_id" jdbcType="INTEGER" property="orderUserId" />
		<result column="is_big" jdbcType="VARCHAR" property="isBig" />
		<result column="phone" jdbcType="VARCHAR" property="phone" />
		<result column="address" jdbcType="VARCHAR" property="address" />
		<result column="pay_status" jdbcType="VARCHAR" property="payStatus" />
		<result column="price" jdbcType="VARCHAR" property="price" />
	</resultMap>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		delete from t_courier_order
		where id = #{id,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.xhr.courier.model.CourierOrder">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		insert into t_courier_order (id, user_id, address_id,
		pickup_code,
		courier, order_id,
		remark, create_time, cabinet_time,price,
		status,
		order_user_id, is_big, phone, address, pay_status)
		values (#{id,jdbcType=INTEGER},
		#{userId,jdbcType=INTEGER},
		#{addressId,jdbcType=VARCHAR},
		#{pickupCode,jdbcType=VARCHAR}, 
		#{courier,jdbcType=VARCHAR},
		#{orderId,jdbcType=INTEGER},
		#{remark,jdbcType=VARCHAR},
		#{createTime,jdbcType=TIMESTAMP},
		#{cabinetTime,jdbcType=TIMESTAMP},
		#{price,jdbcType=VARCHAR},
		#{status,jdbcType=VARCHAR},
		#{orderUserId,jdbcType=INTEGER},
		#{isBig,jdbcType=VARCHAR},
		#{phone,jdbcType=VARCHAR},
		#{address,jdbcType=VARCHAR},
		#{payStatus,jdbcType=VARCHAR})
	</insert>
	<update id="updateByPrimaryKey" parameterType="com.xhr.courier.model.CourierOrder">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		update t_courier_order
		set user_id = #{userId,jdbcType=INTEGER},
		address_id = #{addressId,jdbcType=VARCHAR},
		pickup_code = #{pickupCode,jdbcType=VARCHAR},
		courier = #{courier,jdbcType=VARCHAR},
		order_id = #{orderId,jdbcType=INTEGER},
		price = #{price,jdbcType=VARCHAR},
		remark = #{remark,jdbcType=VARCHAR},
		create_time = #{createTime,jdbcType=TIMESTAMP},
		cabinet_time = #{cabinetTime,jdbcType=TIMESTAMP},
		status = #{status,jdbcType=VARCHAR},
		order_user_id = #{orderUserId,jdbcType=INTEGER}
		where id = #{id,jdbcType=INTEGER}
	</update>
	<select id="selectByPrimaryKey" parameterType="java.lang.Integer"
		resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		select id, user_id, address_id, pickup_code, courier, order_id,
		remark, create_time,price,accept_time,
		cabinet_time, status, order_user_id, is_big, phone, address, pay_status
		from
		t_courier_order
		where id = #{id,jdbcType=INTEGER}
	</select>
	<select id="selectAll" resultMap="BaseResultMap">
		<!-- WARNING - @mbg.generated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sun Jan 26 
			18:17:36 CST 2020. -->
		select id, user_id, address_id, pickup_code, courier, order_id,
		remark, create_time,price,accept_time,
		cabinet_time, status, order_user_id, is_big, phone, address, pay_status
		from
		t_courier_order
	</select>

	<update id="update" parameterType="java.util.Map">
		UPDATE t_courier_order
		<trim prefix="SET" suffixOverrides=",">
			<if test="pickupCode != null and pickupCode != ''">
				pickup_code=#{pickupCode},
			</if>
			<if test="courier != null and courier != ''">
				courier=#{courier},
			</if>
			<if test="cabinetTime != null and cabinetTime != ''">
				cabinet_time=#{cabinetTime},
			</if>
			<if test="status != null and status != ''">
				status=#{status},
			</if>
			<if test="phone != null and phone != ''">
				phone=#{phone},
			</if>
			<if test="address != null and address != ''">
				address=#{address},
			</if>
			<if test="isBig != null and isBig != ''">
				is_big=#{isBig},
			</if>
			<if test="orderUserId != null and orderUserId != ''">
				order_user_id=#{orderUserId},
			</if>
			<if test="payStatus != null and payStatus != ''">
				pay_status=#{payStatus},
			</if>
			<if test="price != null and price != ''">
				price=#{price},
			</if>
			<if test="remark != null and remark != ''">
				remark=#{remark},
			</if>
			<if test="acceptTime != null">
				accept_time=#{acceptTime},
			</if>
		</trim>
		WHERE id=#{id}
	</update>

	<select id="findList" resultType="java.util.Map" parameterType="java.util.Map">
		SELECT a.id,
		a.user_id,
		address_id,
		pickup_code,
		courier,
		order_id,
		remark,
		price,
		cabinet_time,
		a.create_time,
		`status`,
		b.avatar,
		b.user_name,
		order_user_id, 
		is_big, 
		a.phone, 
		address, 
		accept_time, 
		pay_status
		from t_courier_order as a 
		left join t_user as b on a.user_id=b.id
		<where>
			<if test="userId != null and userId != ''">
				and a.user_id=#{userId}
			</if>
			<if test="orderUserId != 0">
				and order_user_id=#{orderUserId}
			</if>
			<if test="payStatus != null and payStatus != ''">
				and pay_status=#{payStatus}
			</if>
			<if test="isBig != null and isBig != ''">
				and is_big=#{isBig}
			</if>
			<if test="sendUser != null and sendUser != ''">
				and b.user_name like '%${sendUser}%'
			</if>
			<if test="status != null and status != ''">
				and a.status=#{status}
			</if>
		</where>
		order by a.create_time desc
	</select>

	<select id="findListIndex" resultType="java.util.Map" parameterType="java.util.Map">
		SELECT a.id,
		a.user_id,
		address_id,
		pickup_code,
		courier,
		order_id,
		remark,
		price,
		cabinet_time,
		a.create_time,
		`status`,
		b.avatar,
		b.user_name,
		order_user_id, 
		is_big, 
		a.phone, 
		address, 
		accept_time, 
		pay_status
		from t_courier_order as a 
		left join t_user as b on a.user_id=b.id
		<where>
			<if test="userId != null and userId != ''">
				and a.user_id=#{userId}
			</if>
			<if test="orderUserId != null and orderUserId != ''">
				and order_user_id=#{orderUserId}
			</if>
			<if test="payStatus != null and payStatus != ''">
				and pay_status=#{payStatus}
			</if>
			<if test="isBig != null and isBig != ''">
				and is_big=#{isBig}
			</if>
			<if test="sendUser != null and sendUser != ''">
				and b.user_name=#{sendUser}
			</if>
			<if test="status != null and status != ''">
				and a.status=#{status}
			</if>
			and (datediff(now(),accept_time) &lt; 1 or accept_time is null)
		</where>
		order by a.create_time desc
	</select>

</mapper>