(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/contract/contract-info"],{"24a0":function(t,n,o){"use strict";o.r(n);var e=o("9b07"),c=o("b467");for(var s in c)"default"!==s&&function(t){o.d(n,t,function(){return c[t]})}(s);o("c850");var a=o("2877"),r=Object(a["a"])(c["default"],e["a"],e["b"],!1,null,null,null);n["default"]=r.exports},3473:function(t,n,o){},"7ad9":function(t,n,o){"use strict";(function(t,e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var c=r(o("128c")),s=o("7e1a"),a=o("4b47");function r(t){return t&&t.__esModule?t:{default:t}}var i=function(){return o.e("components/cmd-nav-bar/cmd-nav-bar").then(o.bind(null,"e2f3"))},u=function(){return o.e("components/cmd-page-body/cmd-page-body").then(o.bind(null,"76fb"))},f=function(){return o.e("components/cmd-transition/cmd-transition").then(o.bind(null,"4129"))},d=function(){return o.e("components/cmd-input/cmd-input").then(o.bind(null,"591c"))},l={components:{cmdNavBar:i,cmdPageBody:u,cmdTransition:f,cmdInput:d},data:function(){return{InputBottom:0,userInfo:{},message:"",toUserId:"",toUserInfo:"",msgList:[],imgUrl:a.imgUrl,height:0}},onLoad:function(n){var o=this,e=this;e.getUserInfo(),e.toUserId=n.toUserId;var c="contract/findContractInfo",a={pageNum:1,size:1e4,toUserId:n.toUserId};if((0,s.getRquest)(c,a).then(function(n){console.info(t(n," at pages\\contract\\contract-info.vue:84")),e.msgList=n.data.rows,console.info(t(e.msgList," at pages\\contract\\contract-info.vue:86"))}).catch(function(n){console.info(t(n," at pages\\contract\\contract-info.vue:88"))}),console.info(t(e.toUserId," at pages\\contract\\contract-info.vue:90")),void 0!=e.toUserId){var r="user/findById/"+e.toUserId;(0,s.getRquest)(r,"").then(function(t){e.toUserInfo=t.data}).catch(function(n){console.info(t(n," at pages\\contract\\contract-info.vue:96"))})}e.connectSocketInit(),setTimeout(function(){o.scrollTo()},500)},methods:{InputFocus:function(t){this.InputBottom=t.detail.height},InputBlur:function(t){this.InputBottom=0},getUserInfo:function(){var t=this;e.getStorage({key:"userInfo",success:function(n){t.userInfo=n.data}})},connectSocketInit:function(){var n=this,o=this;this.socketTask=e.connectSocket({url:"ws://localhost:8080/websocket/"+o.userInfo.id,success:function(n){console.log(t("websocket连接成功"," at pages\\contract\\contract-info.vue:128"))}}),this.socketTask.onOpen(function(e){console.log(t("WebSocket连接正常打开中...！"," at pages\\contract\\contract-info.vue:134")),n.is_open_socket=!0,n.socketTask.onMessage(function(e){console.info(t(e," at pages\\contract\\contract-info.vue:138")),console.log(t("收到服务器内容："+e.data," at pages\\contract\\contract-info.vue:139"));var s={send_user_id:o.toUserId,to_user_id:o.userInfo.id,content:e.data,create_time:(0,c.default)(new Date).format("YYYY-MM-DD HH:mm:ss")};o.msgList.push(s),n.scrollTo()})}),this.socketTask.onClose(function(){console.log(t("已经被关闭了"," at pages\\contract\\contract-info.vue:152"))})},sendMsg:function(){var n=this,o=this;if(""!=o.message){var e="push/"+o.toUserId,a={message:o.message};return(0,s.getRquest)(e,a).then(function(e){var s={send_user_id:o.userInfo.id,to_user_id:o.toUserId,content:o.message,create_time:(0,c.default)(new Date).format("YYYY-MM-DD HH:mm:ss")};o.msgList.push(s),console.info(t(o.msgList," at pages\\contract\\contract-info.vue:172")),n.scrollTo(),o.message="",console.info(t(e," at pages\\contract\\contract-info.vue:175"))}).catch(function(n){console.info(t(n," at pages\\contract\\contract-info.vue:177"))})}},scrollTo:function(){var t=this;e.getSystemInfo({success:function(n){t.height=n.windowHeight}}),e.pageScrollTo({scrollTop:99999,duration:300})}},filters:{dateFilter:function(t){return(0,c.default)(t).format("YYYY-MM-DD HH:mm:ss")}}};n.default=l}).call(this,o("0de9")["default"],o("6e42")["default"])},"9b07":function(t,n,o){"use strict";var e=function(){var t=this,n=t.$createElement,o=(t._self._c,t.__map(t.msgList,function(n,o){var e=t._f("dateFilter")(n.create_time),c=t._f("dateFilter")(n.create_time);return{$orig:t.__get_orig(n),f0:e,f1:c}}));t.$mp.data=Object.assign({},{$root:{l0:o}})},c=[];o.d(n,"a",function(){return e}),o.d(n,"b",function(){return c})},b467:function(t,n,o){"use strict";o.r(n);var e=o("7ad9"),c=o.n(e);for(var s in e)"default"!==s&&function(t){o.d(n,t,function(){return e[t]})}(s);n["default"]=c.a},c850:function(t,n,o){"use strict";var e=o("3473"),c=o.n(e);c.a}},[["696f","common/runtime","common/vendor"]]]);